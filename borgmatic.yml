location:
  repositories:
    - {{ env "BORGBASE_REPO" }}

  storage:
    compression: auto,zstd
    encryption_passphrase: CHANGEME
    archive_name_format: "{hostname}-{now}"
    ssh_command: ssh -i /run/secrets/backup_bot_ssh_key

  retention:
    keep_daily: 3
    keep_weekly: 4
    keep_monthly: 12
    keep_yearly: 2
    prefix: "{hostname}-"

  consistency:
    checks:
      - disabled
    check_last: 3
    prefix: "{hostname}-"

hooks:
  mysql_databases:
    - name: {{ env "DB_TABLE" }}
      hostname: {{ env "DB_HOST" }}
      port: 3306
      username: {{ env "DB_USER" }}
      password: {{ secret "db_password" }}
